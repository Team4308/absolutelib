def vendorRoot = file("$buildDir/allOutputs")  // adjust if needed
def vendorJsons = fileTree(vendorRoot).matching { include "**/*.json" }.files.toList()

logger.lifecycle("[combine] Searching for vendor JSONs under: ${vendorRoot}")
vendorJsons.each { logger.lifecycle("[combine] Found vendor JSON: ${it}") }

if (vendorJsons.isEmpty()) {
    if (project.hasProperty("allowEmptyThirdparty")) {
        logger.lifecycle("[combine] No vendor JSONs found. Skipping publish (allowEmptyThirdparty set).")
        return
    } else {
        logger.lifecycle("[combine] No vendor JSONs found. Skipping publish gracefully.")
        return // prevent .first() exception
    }
}

def firstVendor = vendorJsons.first()
